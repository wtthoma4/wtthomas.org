<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="HackPackCTF 2025: Pharoahs" /><meta property="og:locale" content="en" /><meta name="description" content="Category: Crypto Difficulty: Medium Points: 500" /><meta property="og:description" content="Category: Crypto Difficulty: Medium Points: 500" /><link rel="canonical" href="https://www.wtthomas.org/posts/HackPackCTF-Pharoahs/" /><meta property="og:url" content="https://www.wtthomas.org/posts/HackPackCTF-Pharoahs/" /><meta property="og:site_name" content="Taylor Thomas" /><meta property="og:image" content="https://www.wtthomas.org/assets/img/posts/HackPackCTF/hackpack-logo.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-05-19T04:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://www.wtthomas.org/assets/img/posts/HackPackCTF/hackpack-logo.png" /><meta property="twitter:title" content="HackPackCTF 2025: Pharoahs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-19T04:00:00-04:00","datePublished":"2025-05-19T04:00:00-04:00","description":"Category: Crypto Difficulty: Medium Points: 500","headline":"HackPackCTF 2025: Pharoahs","image":"https://www.wtthomas.org/assets/img/posts/HackPackCTF/hackpack-logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.wtthomas.org/posts/HackPackCTF-Pharoahs/"},"url":"https://www.wtthomas.org/posts/HackPackCTF-Pharoahs/"}</script><title>HackPackCTF 2025: Pharoahs | Taylor Thomas</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Taylor Thomas"><meta name="application-name" content="Taylor Thomas"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Taylor Thomas</a><p class="site-subtitle fst-italic mb-0">CyberSecurity & Computer Science @ NCSU.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/cv/" class="nav-link"> <i class="fa-fw fas fa-file-pdf"></i> <span>CV</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/wtthoma4" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://www.wtthomas.org" aria-label="links" target="_blank" rel="noopener noreferrer" > <i class="fa-solid fa-link"></i> </a> <a href="javascript:location.href = 'mailto:' + ['taylor','wtthomas.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/taylor-t-a18294266/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>HackPackCTF 2025: Pharoahs</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>HackPackCTF 2025: Pharoahs</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1747641600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 19, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/img/posts/HackPackCTF/hackpack-logo.png" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/HackPackCTF/hackpack-logo.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/wtthoma4">Taylor Thomas</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2976 words" > <em>16 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">HackPackCTF 2025: Pharoahs</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">HackPackCTF 2025: Pharoahs</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><ul><li>Category: <strong>Crypto</strong><li>Difficulty: <strong>Medium</strong><li>Points: <strong>500</strong></ul><p>The source code for pharoahs is below:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">from</span> <span class="n">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="n">secrets</span>

<span class="k">def</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">digit</span> <span class="o">=</span> <span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">col</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">digit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">key_slice</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="n">end</span><span class="p">)</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v1</span> <span class="o">^</span> <span class="n">v2</span>

<span class="k">def</span> <span class="nf">sbox</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">rot1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">rot2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">rot1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">bit_num_l</span><span class="p">,</span> <span class="n">bit_num_r</span> <span class="o">=</span> <span class="n">rot1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rot1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">l_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_l</span><span class="p">)</span>
        <span class="n">r_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">l_mask</span><span class="p">,</span> <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">l_val</span> <span class="o">==</span> <span class="n">r_val</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_l</span><span class="p">)</span>
            <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">l_mask</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">r_mask</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">rot2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">bit_num_l</span><span class="p">,</span> <span class="n">bit_num_r</span> <span class="o">=</span> <span class="n">rot2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rot2</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">l_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_l</span><span class="p">)</span>
        <span class="n">r_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">l_mask</span><span class="p">,</span> <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">l_val</span> <span class="o">==</span> <span class="n">r_val</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_l</span><span class="p">)</span>
            <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">l_mask</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">r_mask</span>
    <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">one_round</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">input_bits</span> <span class="o">=</span> <span class="nf">sbox</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">key_mask</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">bin</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="nf">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">input_bits</span> <span class="o">=</span> <span class="n">input_bits</span> <span class="o">^</span> <span class="n">key_mask</span>
    <span class="k">return</span> <span class="n">input_bits</span>

<span class="k">def</span> <span class="nf">cipher</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">rounds</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">rounds</span><span class="p">):</span>
        <span class="n">input_bits</span> <span class="o">=</span> <span class="nf">one_round</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="nf">key_slice</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">16</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="mi">16</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">input_bits</span>

<span class="k">def</span> <span class="nf">divide_into_blocks</span><span class="p">(</span><span class="n">input_str</span><span class="p">):</span>
    <span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">input_str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">31</span> <span class="ow">and</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">127</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">blocks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">''</span><span class="p">)</span>
            <span class="n">blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="n">ctr</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Only alphanumeric and special characters allowed!</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)):</span>
        <span class="n">hex_blk</span> <span class="o">=</span> <span class="sh">''</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">hex_blk</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">%x</span><span class="sh">'</span><span class="o">%</span><span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hex_blk</span>
    <span class="k">return</span> <span class="n">blocks</span>

<span class="k">def</span> <span class="nf">print_border</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_header</span><span class="p">():</span>
    <span class="nf">print_border</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">HERE LIES THE TOMB OF THE CYBER PHAROAHS</span><span class="sh">'</span><span class="si">:</span><span class="o">^</span><span class="mi">40</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print_border</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">print_menu</span><span class="p">():</span>
    <span class="nf">print_header</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">1. Raid the Tomb</span><span class="se">\n</span><span class="s">2. Divine the Oracles</span><span class="se">\n</span><span class="s">3. Read the Hieroglyphs</span><span class="se">\n</span><span class="s">4. Make an Offering</span><span class="se">\n</span><span class="s">Or... Leave the Tomb</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">print_border</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">load_dotenv</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">FLAG</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">secrets</span><span class="p">.</span><span class="nf">randbits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">flag_blocks</span> <span class="o">=</span> <span class="nf">divide_into_blocks</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="n">enc_flag_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">cipher</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">flag_blocks</span><span class="p">]</span>
    <span class="n">enc_flag</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="sh">'</span><span class="s">%x</span><span class="sh">'</span><span class="o">%</span><span class="n">block</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">enc_flag_blocks</span><span class="p">])</span>
    <span class="n">rounds</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="nf">print_menu</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="s">What do you do?</span><span class="se">\n</span><span class="sh">'</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">ch</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nb">ValueError</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">user_input</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="s">Decipher the glyphs to proceed:</span><span class="sh">'</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">user_input</span> <span class="o">==</span> <span class="n">flag</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Congratulations! Glory and treasure awaits you!</span><span class="sh">'</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Incorrect. Try again!</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">plaintext</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="s">Enter message: </span><span class="sh">'</span><span class="p">)</span>
                <span class="n">plain_blocks</span> <span class="o">=</span> <span class="nf">divide_into_blocks</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
                <span class="n">cipher_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">cipher</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">key</span><span class="p">,</span> <span class="n">rounds</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">plain_blocks</span><span class="p">]</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Oracle:</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="sh">'</span><span class="s">%x</span><span class="sh">'</span><span class="o">%</span><span class="n">block</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">cipher_blocks</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">The Hieroglyphs read:</span><span class="sh">'</span><span class="p">,</span> <span class="n">enc_flag</span><span class="p">)</span>
                <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">challenge.py</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">rounds</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="s">How many rounds do you wish to offer? </span><span class="sh">'</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">rounds</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">rounds</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
                        <span class="n">rounds</span> <span class="o">=</span> <span class="mi">8</span>
                        <span class="k">raise</span> <span class="nb">ValueError</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Offering made. May the Pharoahs smile upon you.</span><span class="sh">'</span><span class="p">)</span>
                <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">The Pharoahs will not be pleased with such an offering.</span><span class="sh">'</span><span class="p">)</span>
                    <span class="n">rounds</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="s">Do you really wish to abandon your claim to fortune? (y/n) </span><span class="sh">'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">:</span>
                <span class="k">break</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><h1 id="clues">Clues</h1><p>We need to break down the source code and understand how the challenge works. First, the program loads the environement, gets the flag from the environment, and generates a random key.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">load_dotenv</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">FLAG</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">secrets</span><span class="p">.</span><span class="nf">randbits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
</pre></table></code></div></div><p>Next, it calls two functions, it uses <code class="language-plaintext highlighter-rouge">divide_into_blocks()</code>and <code class="language-plaintext highlighter-rouge">cipher()</code> to encrypt the flag:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">flag_blocks</span> <span class="o">=</span> <span class="nf">divide_into_blocks</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="n">enc_flag_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">cipher</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">flag_blocks</span><span class="p">]</span>
<span class="n">enc_flag</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="sh">'</span><span class="s">%x</span><span class="sh">'</span><span class="o">%</span><span class="n">block</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">enc_flag_blocks</span><span class="p">])</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">divide_into_blocks()</code> takes the input string and converts it into 16-byte blocks without padding. A 20-byte input string would result in a two-element array, one 32-character string and one 8 character string. The characters are converted to their hexadecimal representations, so each array element is a 32-character string except the last element which can vary in length.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">divide_into_blocks</span><span class="p">(</span><span class="n">input_str</span><span class="p">):</span>
    <span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">input_str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">31</span> <span class="ow">and</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">127</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">blocks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">''</span><span class="p">)</span>
            <span class="n">blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="n">ctr</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Only alphanumeric and special characters allowed!</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)):</span>
        <span class="n">hex_blk</span> <span class="o">=</span> <span class="sh">''</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">hex_blk</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">%x</span><span class="sh">'</span><span class="o">%</span><span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hex_blk</span>
    <span class="k">return</span> <span class="n">blocks</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">cipher()</code> function is used in the bounds of a for loop iterating over the blocks generated by <code class="language-plaintext highlighter-rouge">divide_into_blocks()</code>. The <code class="language-plaintext highlighter-rouge">one_round()</code> function is called on the input data one time for each <code class="language-plaintext highlighter-rouge">round</code>, default 8 times. Each time, the input data is the result of the previous <code class="language-plaintext highlighter-rouge">one_round()</code>, and the next two bytes (16 bits) of the encryption key:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">cipher</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">rounds</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">rounds</span><span class="p">):</span>
        <span class="n">input_bits</span> <span class="o">=</span> <span class="nf">one_round</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="nf">key_slice</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">16</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="mi">16</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">input_bits</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">one_round()</code> function uses <code class="language-plaintext highlighter-rouge">sbox()</code> to “scramble” the input, then XORs with a section of the encryption key.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">one_round</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">input_bits</span> <span class="o">=</span> <span class="nf">sbox</span><span class="p">(</span><span class="n">input_bits</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">key_mask</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">bin</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="nf">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">input_bits</span> <span class="o">=</span> <span class="n">input_bits</span> <span class="o">^</span> <span class="n">key_mask</span>
    <span class="k">return</span> <span class="n">input_bits</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">sbox()</code> functions scramble is done by performing a series of conditional bit swaps based on two predefined sequences of position pairs. For each pair of positions in the sequences, it compares the bits at those locations and swaps them only if they are different from each other. This results in a predictable rearrangement of bits within that row:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">sbox</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">rot1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">rot2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">rot1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">bit_num_l</span><span class="p">,</span> <span class="n">bit_num_r</span> <span class="o">=</span> <span class="n">rot1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rot1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">l_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_l</span><span class="p">)</span>
        <span class="n">r_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">l_mask</span><span class="p">,</span> <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">l_val</span> <span class="o">==</span> <span class="n">r_val</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_l</span><span class="p">)</span>
            <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">l_mask</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">r_mask</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">rot2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">bit_num_l</span><span class="p">,</span> <span class="n">bit_num_r</span> <span class="o">=</span> <span class="n">rot2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rot2</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">l_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_l</span><span class="p">)</span>
        <span class="n">r_val</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">l_mask</span><span class="p">,</span> <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">l_val</span> <span class="o">==</span> <span class="n">r_val</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_l</span><span class="p">)</span>
            <span class="n">r_mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">bit_num_r</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">l_mask</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">^</span> <span class="n">r_mask</span>
    <span class="k">return</span> <span class="n">n</span>
</pre></table></code></div></div><p>The remaining section of <code class="language-plaintext highlighter-rouge">main()</code> is control flow, but if you look under option 2, you will see that the same encryption functions are used to encrypt plaintext from the user as were used to encrypt the flag:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="s">Enter message: </span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plain_blocks</span> <span class="o">=</span> <span class="nf">divide_into_blocks</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
    <span class="n">cipher_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">cipher</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">key</span><span class="p">,</span> <span class="n">rounds</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">plain_blocks</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Oracle:</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="sh">'</span><span class="s">%x</span><span class="sh">'</span><span class="o">%</span><span class="n">block</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">cipher_blocks</span><span class="p">]))</span>
</pre></table></code></div></div><p>However, option 4 lets us change the number of rounds of encryption that are performed. This only applies to our plaintext encryption, but it allows us to observe the intermediary ciphertext used in the full 8-round encryption.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">rounds</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">'</span><span class="s">How many rounds do you wish to offer? </span><span class="sh">'</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">rounds</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">rounds</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">rounds</span> <span class="o">=</span> <span class="mi">8</span>
            <span class="k">raise</span> <span class="nb">ValueError</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Offering made. May the Pharoahs smile upon you.</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">The Pharoahs will not be pleased with such an offering.</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">rounds</span> <span class="o">=</span> <span class="mi">8</span>
</pre></table></code></div></div><h1 id="solution">Solution</h1><p>We have the power to:</p><ul><li>Get the encrypted flag<li>Input our own plaintext and encrypt it<li>Control the number of rounds used We put all of these together to form an attack chain.</ul><h2 id="step-1-start-new-session-new-key-and-retrieve-encrypted-flag"><span class="me-2">Step 1: Start New Session (new key) and Retrieve Encrypted Flag</span><a href="#step-1-start-new-session-new-key-and-retrieve-encrypted-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>User input is bracketed &lt;<span class="o">&gt;</span> to make this easier to follow.
<span class="gp">$</span><span class="w"> </span>python3 challenge.py
<span class="go">========================================
HERE LIES THE TOMB OF THE CYBER PHAROAHS
========================================
1. Raid the Tomb
2. Divine the Oracles
3. Read the Hieroglyphs
4. Make an Offering
Or... Leave the Tomb
========================================

What do you do?
</span><span class="gp">&lt;3&gt;</span><span class="w">
</span><span class="go">The Hieroglyphs read: db045364cff595f98ff94572cff51df9
</span><span class="c">...
</span><span class="go">[challenge source code]
</span><span class="c">...
</span></pre></table></code></div></div><h2 id="step-2-use-know-plaintext-and-record-encryption-rounds"><span class="me-2">Step 2: Use Know Plaintext and Record Encryption Rounds</span><a href="#step-2-use-know-plaintext-and-record-encryption-rounds" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c">...
</span><span class="go">[challenge source code]
</span><span class="c">...
</span><span class="go">========================================
HERE LIES THE TOMB OF THE CYBER PHAROAHS
========================================
1. Raid the Tomb
2. Divine the Oracles
3. Read the Hieroglyphs
4. Make an Offering
Or... Leave the Tomb
========================================

What do you do?
</span><span class="gp">&lt;4&gt;</span><span class="w">
</span><span class="gp">How many rounds do you wish to offer? &lt;1&gt;</span><span class="w">
</span><span class="go">Offering made. May the Pharoahs smile upon you.
========================================
HERE LIES THE TOMB OF THE CYBER PHAROAHS
========================================
1. Raid the Tomb
2. Divine the Oracles
3. Read the Hieroglyphs
4. Make an Offering
Or... Leave the Tomb
========================================

What do you do?
2
</span><span class="gp">Enter message: &lt;AAAAAAAAAAAAAAAA&gt;</span><span class="w">
</span><span class="go">Oracle: c818c818c818c818c818c818c818c818
</span></pre></table></code></div></div><p>Now repeat the above steps. Use option 4, increment the number of rounds by one, then use the same input “AAAAAAAAAAAAAAAA” and record the output ciphertext. Do this for rounds 1-8. You shold have 8 different ciphertexts at the end.</p><h2 id="step-3-use-8-ciphertexts-to-decrypt-the--flag"><span class="me-2">Step 3: Use 8 Ciphertexts To Decrypt the Flag</span><a href="#step-3-use-8-ciphertexts-to-decrypt-the--flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We will use the following python program to perform the key extraction and decryption. This program works by taking each ciphertext from rounds one through eight and constructing the complete encryption key. The s-box transformations can be reversed logically, and because the encryption is a simple XOR, it can be reversed. Once the complete encryption key is constructed, the s-box scrambling is reversed logically and the XOR operation is reversed using the completed key.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Extract a specific bit from a 128-bit number at position (row, col)</span><span class="sh">"""</span>
    <span class="n">digit</span> <span class="o">=</span> <span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">col</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">digit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">flip_bits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Flip two bits at specified positions in a row</span><span class="sh">"""</span>
    <span class="n">digit1</span> <span class="o">=</span> <span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">pos1</span>
    <span class="n">digit2</span> <span class="o">=</span> <span class="mi">127</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">row</span> <span class="o">-</span> <span class="n">pos2</span>
    
    <span class="n">mask1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">digit1</span>
    <span class="n">mask2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">digit2</span>
    
    <span class="k">return</span> <span class="n">n</span> <span class="o">^</span> <span class="n">mask1</span> <span class="o">^</span> <span class="n">mask2</span>

<span class="k">def</span> <span class="nf">sbox_row</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Apply S-box transformation to a single row (simplified version)</span><span class="sh">"""</span>
    <span class="c1"># Bit positions to swap in pairs
</span>    <span class="n">swap_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> 
                  <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span> <span class="ow">in</span> <span class="n">swap_pairs</span><span class="p">:</span>
        <span class="n">bit1</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos1</span><span class="p">)</span>
        <span class="n">bit2</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bit1</span> <span class="o">!=</span> <span class="n">bit2</span><span class="p">:</span>  <span class="c1"># Only swap if bits are different
</span>            <span class="n">n</span> <span class="o">=</span> <span class="nf">flip_bits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">apply_sbox</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Apply S-box transformation to all 8 rows</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sbox_row</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">reverse_sbox_row</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Reverse S-box transformation for a single row</span><span class="sh">"""</span>
    <span class="c1"># Apply swaps in reverse order
</span>    <span class="n">swap_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> 
                  <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="n">swap_pairs</span><span class="p">):</span>
        <span class="n">bit1</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos1</span><span class="p">)</span>
        <span class="n">bit2</span> <span class="o">=</span> <span class="nf">bit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bit1</span> <span class="o">!=</span> <span class="n">bit2</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nf">flip_bits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">reverse_sbox</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Reverse S-box transformation for all 8 rows</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">reverse_sbox_row</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">text_to_int</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Convert ASCII text to integer</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="si">:</span><span class="mi">02</span><span class="n">x</span><span class="si">}</span><span class="sh">'</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">text</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">int_to_text</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Convert integer back to ASCII text</span><span class="sh">"""</span>
    <span class="n">hex_str</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="mi">0</span><span class="si">{</span><span class="n">length</span><span class="o">*</span><span class="mi">2</span><span class="si">}</span><span class="n">x</span><span class="si">}</span><span class="sh">'</span>
    <span class="n">result</span> <span class="o">=</span> <span class="sh">""</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">hex_str</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">hex_str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">char_code</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">hex_str</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
                <span class="k">if</span> <span class="mi">32</span> <span class="o">&lt;=</span> <span class="n">char_code</span> <span class="o">&lt;</span> <span class="mi">127</span><span class="p">:</span>  <span class="c1"># Printable ASCII
</span>                    <span class="n">result</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">char_code</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">.</span><span class="sh">'</span>  <span class="c1"># Non-printable
</span>            <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">.</span><span class="sh">'</span>
    
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">create_key_mask</span><span class="p">(</span><span class="n">key_slice</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Create 128-bit key mask by repeating 16-bit slice</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">key_slice</span><span class="si">:</span><span class="mi">016</span><span class="n">b</span><span class="si">}</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">extract_key_slice</span><span class="p">(</span><span class="n">full_key</span><span class="p">,</span> <span class="n">round_num</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Extract 16-bit key slice for a specific round</span><span class="sh">"""</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="mi">112</span> <span class="o">-</span> <span class="p">(</span><span class="n">round_num</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">full_key</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>

<span class="k">def</span> <span class="nf">decrypt_round</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Reverse one round of encryption</span><span class="sh">"""</span>
    <span class="c1"># Remove key mask
</span>    <span class="n">key_mask</span> <span class="o">=</span> <span class="nf">create_key_mask</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">^</span> <span class="n">key_mask</span>
    
    <span class="c1"># Reverse S-box transformations
</span>    <span class="k">return</span> <span class="nf">reverse_sbox</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">recover_key_slices</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">round_outputs</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Recover all key slices using chosen plaintext attack</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Recovering key slices...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">key_slices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_state</span> <span class="o">=</span> <span class="n">plaintext</span>
    
    <span class="k">for</span> <span class="n">round_num</span><span class="p">,</span> <span class="n">output_hex</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">round_outputs</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">output_hex</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        
        <span class="c1"># Apply S-box to current state
</span>        <span class="n">sboxed</span> <span class="o">=</span> <span class="nf">apply_sbox</span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span>
        
        <span class="c1"># Key slice is revealed by the XOR
</span>        <span class="n">key_mask</span> <span class="o">=</span> <span class="n">sboxed</span> <span class="o">^</span> <span class="n">output</span>
        <span class="n">key_slice</span> <span class="o">=</span> <span class="p">(</span><span class="n">key_mask</span> <span class="o">&gt;&gt;</span> <span class="mi">112</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
        
        <span class="n">key_slices</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Round </span><span class="si">{</span><span class="n">round_num</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s">: Key slice = 0x</span><span class="si">{</span><span class="n">key_slice</span><span class="si">:</span><span class="mi">04</span><span class="n">x</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># Update state for next round (this becomes input to next round)
</span>        <span class="n">current_state</span> <span class="o">=</span> <span class="n">output</span>
    
    <span class="k">return</span> <span class="n">key_slices</span>

<span class="k">def</span> <span class="nf">build_full_key</span><span class="p">(</span><span class="n">key_slices</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Construct 128-bit key from 8 key slices</span><span class="sh">"""</span>
    <span class="n">full_key</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key_slice</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">key_slices</span><span class="p">):</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="mi">112</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">full_key</span> <span class="o">|=</span> <span class="p">(</span><span class="n">key_slice</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">full_key</span>

<span class="k">def</span> <span class="nf">decrypt_flag</span><span class="p">(</span><span class="n">encrypted_hex</span><span class="p">,</span> <span class="n">full_key</span><span class="p">,</span> <span class="n">rounds</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Decrypt the flag using recovered key</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Decrypting flag...</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Parse encrypted data into 128-bit blocks
</span>    <span class="n">block_size</span> <span class="o">=</span> <span class="mi">32</span>  <span class="c1"># 32 hex chars = 128 bits
</span>    <span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">encrypted_hex</span><span class="p">),</span> <span class="n">block_size</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">block_size</span> <span class="o">&lt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">encrypted_hex</span><span class="p">):</span>
            <span class="n">block_hex</span> <span class="o">=</span> <span class="n">encrypted_hex</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">block_size</span><span class="p">]</span>
            <span class="n">blocks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">block_hex</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Found </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span><span class="si">}</span><span class="s"> encrypted blocks</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Decrypt each block
</span>    <span class="n">decrypted_blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">block</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">blocks</span><span class="p">):</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">block</span>
        
        <span class="c1"># Reverse all rounds
</span>        <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">rounds</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">key_slice</span> <span class="o">=</span> <span class="nf">extract_key_slice</span><span class="p">(</span><span class="n">full_key</span><span class="p">,</span> <span class="n">round_num</span><span class="p">)</span>
            <span class="n">current</span> <span class="o">=</span> <span class="nf">decrypt_round</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">)</span>
        
        <span class="n">decrypted_blocks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        
        <span class="c1"># Show intermediate results
</span>        <span class="n">block_text</span> <span class="o">=</span> <span class="nf">int_to_text</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Block </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">: 0x</span><span class="si">{</span><span class="n">current</span><span class="si">:</span><span class="mi">032</span><span class="n">x</span><span class="si">}</span><span class="s"> -&gt; </span><span class="sh">'</span><span class="si">{</span><span class="n">block_text</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
    
    <span class="c1"># Combine blocks into final flag
</span>    <span class="n">flag</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">int_to_text</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">decrypted_blocks</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flag</span><span class="p">.</span><span class="nf">rstrip</span><span class="p">(</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Remove null padding
</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    
    <span class="c1"># Known plaintext (16 'A' characters)
</span>    <span class="n">plaintext</span> <span class="o">=</span> <span class="sh">"</span><span class="s">AAAAAAAAAAAAAAAA</span><span class="sh">"</span>
    <span class="n">plaintext_int</span> <span class="o">=</span> <span class="nf">text_to_int</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Attack plaintext: </span><span class="sh">'</span><span class="si">{</span><span class="n">plaintext</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Plaintext as int: 0x</span><span class="si">{</span><span class="n">plaintext_int</span><span class="si">:</span><span class="mi">032</span><span class="n">x</span><span class="si">}</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Ciphertext responses for each round (obtained from oracle)
</span>    <span class="n">round_responses</span> <span class="o">=</span> <span class="p">[</span>
		
    <span class="p">]</span>
    
    <span class="c1"># Get encrypted flag from user
</span>    <span class="n">encrypted_flag</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Enter the encrypted flag (hex): </span><span class="sh">"</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
    
    <span class="c1"># Step 1: Recover all key slices
</span>    <span class="n">key_slices</span> <span class="o">=</span> <span class="nf">recover_key_slices</span><span class="p">(</span><span class="n">plaintext_int</span><span class="p">,</span> <span class="n">round_responses</span><span class="p">)</span>
    
    <span class="c1"># Step 2: Build full key
</span>    <span class="n">full_key</span> <span class="o">=</span> <span class="nf">build_full_key</span><span class="p">(</span><span class="n">key_slices</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Recovered full key: 0x</span><span class="si">{</span><span class="n">full_key</span><span class="si">:</span><span class="mi">032</span><span class="n">x</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Step 3: Decrypt the flag
</span>    <span class="n">flag</span> <span class="o">=</span> <span class="nf">decrypt_flag</span><span class="p">(</span><span class="n">encrypted_flag</span><span class="p">,</span> <span class="n">full_key</span><span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">RECOVERED FLAG: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><p>After inputting the <code class="language-plaintext highlighter-rouge">round_responses</code> into the program above and running it, we get the following output:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>python <span class="s1">'.\decrypt.py'</span>
<span class="go">Attack plaintext: 'AAAAAAAAAAAAAAAA'
Plaintext as int: 0x41414141414141414141414141414141

Enter the encrypted flag (hex): db045364cff595f98ff94572cff51df9
Recovering key slices...
Round 1: Key slice = 0x5c08
Round 2: Key slice = 0x7e73
Round 3: Key slice = 0x28c6
Round 4: Key slice = 0x1648
Round 5: Key slice = 0xb993
Round 6: Key slice = 0xa6d0
Round 7: Key slice = 0xd1b4
Round 8: Key slice = 0xdcd6

Recovered full key: 0x5c087e7328c61648b993a6d0d1b4dcd6

Decrypting flag...
Found 1 encrypted blocks
</span><span class="gp">Block 1: 0x000000666c61677b6d795f666c61677d -&gt;</span><span class="w"> </span><span class="s1">'...flag{my_flag}'</span>
<span class="go">
==================================================
RECOVERED FLAG: ...flag{my_flag}
</span></pre></table></code></div></div><blockquote class="prompt-info"><p>Note: I am running the source code on my system for demonstration so the flag format does not match the normal HackPack format.</p></blockquote><p>Now, we go back to the challenge program (same session!) and put in our decrypted flag:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="go">========================================
HERE LIES THE TOMB OF THE CYBER PHAROAHS
========================================
1. Raid the Tomb
2. Divine the Oracles
3. Read the Hieroglyphs
4. Make an Offering
Or... Leave the Tomb
========================================

What do you do?
1
Decipher the glyphs to proceed:flag{my_flag}
Congratulations! Glory and treasure awaits you!
</span></pre></table></code></div></div><p>Victory!</p><blockquote class="prompt-tip"><p>The majority of the effort to solve this challenge is not represented in this article. There were many hours of reading, thinking, and developing the exploit python code. If you’re new to crypto, it can be intimidating, but keep trying!</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/ctf/">CTF</a>, <a href="/categories/hackpackctf/">HackPackCTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/hackpackctf/" class="post-tag no-text-decoration" >HackPackCTF</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Custom-Domain,-Bot-Protection,-and-Region-Locks-on-GitHub-Pages-with-Cloudflare/">Custom Domain, Bot Protection, and Region Locks on GitHub Pages with Cloudflare</a><li class="text-truncate lh-lg"> <a href="/posts/27-Million-Read-Errors/">27 Million Read Errors</a><li class="text-truncate lh-lg"> <a href="/posts/HackPackCTF-Pharoahs/">HackPackCTF 2025: Pharoahs</a><li class="text-truncate lh-lg"> <a href="/posts/HackPackCTF-FileForest/">HackPackCTF 2025: FileForest</a><li class="text-truncate lh-lg"> <a href="/posts/HackPackCTF-WeAreGreenLLC/">HackPackCTF 2025: WeAreGreenLLC</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/hackpackctf/">HackPackCTF</a> <a class="post-tag btn btn-outline-primary" href="/tags/dns/">DNS</a> <a class="post-tag btn btn-outline-primary" href="/tags/cloudflare/">Cloudflare</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">GitHub</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/storage/">Storage</a> <a class="post-tag btn btn-outline-primary" href="/tags/truenas/">TrueNAS</a> <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/HackPackCTF-FileForest/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1746691200" data-df="ll" > May 8, 2025 </time><h4 class="pt-0 my-2">HackPackCTF 2025: FileForest</h4><div class="text-muted"><p>Category: PWN Difficulty: Easy Points: 500 FileForest begins by using netcat to access a remote environment. You can explore this environment using ls, cd, and cat. You should quickly discove...</p></div></div></a></article><article class="col"> <a href="/posts/HackPackCTF-WeAreGreenLLC/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1746086400" data-df="ll" > May 1, 2025 </time><h4 class="pt-0 my-2">HackPackCTF 2025: WeAreGreenLLC</h4><div class="text-muted"><p>Category: PWN Difficulty: Easy Points: 500 Below is the full source code provided for the challenge: from os import getenv import re from sys import stdout import __builtin__ import inspect ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/HackPackCTF-FileForest/" class="btn btn-outline-primary" aria-label="Older" ><p>HackPackCTF 2025: FileForest</p></a> <a href="/posts/27-Million-Read-Errors/" class="btn btn-outline-primary" aria-label="Newer" ><p>27 Million Read Errors</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/wtthoma4">Taylor Thomas</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Red and White Forever!</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/hackpackctf/">HackPackCTF</a> <a class="post-tag btn btn-outline-primary" href="/tags/dns/">DNS</a> <a class="post-tag btn btn-outline-primary" href="/tags/cloudflare/">Cloudflare</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">GitHub</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/storage/">Storage</a> <a class="post-tag btn btn-outline-primary" href="/tags/truenas/">TrueNAS</a> <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
